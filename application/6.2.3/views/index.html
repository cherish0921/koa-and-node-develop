<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>首页</title>
    <link rel="stylesheet" href="./css/index.css">
</head>

<body>
    <div id="app">
        <el-row type="flex" class="row-bg" justify="center">
            <el-col :xs="22" :sm="20" :md="20" :lg="20">
                <!-- TODO: 搜索栏 -->
                <el-form :inline="true" :model="formInline" class="demo-form-inline">
                    <el-form-item>
                        <el-input v-model="formInline.userName" placeholder="请输入用户名"></el-input>
                    </el-form-item>
                    <el-form-item>
                        <el-input v-model="formInline.invitorName" placeholder="请输入邀请人"></el-input>
                    </el-form-item>
                    <el-form-item>
                        <el-input v-model="formInline.mobile" placeholder="请输入用户手机号"></el-input>
                    </el-form-item>
                    <el-form-item>
                        <el-select v-model="formInline.status" placeholder="请选择用户状态">
                            <el-option label="全部" value=""></el-option>
                            <el-option label="正常" value="0"></el-option>
                            <el-option label="禁用" value="1"></el-option>
                        </el-select>
                    </el-form-item>
                    <el-form-item>
                        <el-select v-model="formInline.role" placeholder="请选择用户角色">
                            <el-option label="全部" value=""></el-option>
                            <el-option label="一般用户" value="0"></el-option>
                            <el-option label="VIP" value="1"></el-option>
                            <el-option label="管理员" value="2"></el-option>
                        </el-select>
                    </el-form-item>
                    <el-form-item>
                        <el-button type="primary" @click="onSubmit">查询</el-button>
                        <el-button @click="hanle(null,null,'add')">新增用户</el-button>
                    </el-form-item>
                </el-form>
                <!-- TODO: table表格 -->
                <el-table :data="tableData" border style="width: 100%">
                    <el-table-column prop="" label="序号"></el-table-column>
                    <el-table-column prop="" label="用户名"></el-table-column>
                    <el-table-column prop="" label="手机号"></el-table-column>
                    <el-table-column label="注册时间"></el-table-column>
                    <el-table-column prop="" label="邀请人"></el-table-column>
                    <el-table-column label="用户类型"></el-table-column>
                    <el-table-column label="用户状态"></el-table-column>
                    <el-table-column label="操作" width="250">
                        <template slot-scope="scope">
                            <el-button size="mini" @click="handleEdit(scope.$index, scope.row, 'useredit')">编辑
                            </el-button>
                        </template>
                    </el-table-column>
                </el-table>
                <!-- TODO: 分页栏 -->
                <el-row type="flex" class="row-bg pagination" justify="end" v-if="totalCount">
                    <el-pagination @size-change="handleSizeChange" @current-change="handleCurrentChange" :current-page="formInline.pageNo"
                        :page-sizes="[10, 20, 30, 40]" :page-size="formInline.pageSize" layout="total, sizes, prev, pager, next, jumper"
                        :total="totalCount">
                    </el-pagination>
                </el-row>
            </el-col>
        </el-row>
        <el-dialog :title="dialogopt.title" :visible.sync="dialogopt.dialogFormVisible">
            <el-form :model="form" label-width="80px">
                <el-form-item label="用户名">
                    <el-input v-model="form.userName" autocomplete="off"></el-input>
                </el-form-item>
                <el-form-item label="邮箱">
                    <el-input v-model="form.email" autocomplete="off"></el-input>
                </el-form-item>
                <el-form-item label="投资额">
                    <el-input v-model="form.investAmount" autocomplete="off"></el-input>
                </el-form-item>
                <el-form-item label="邀请人">
                    <el-input v-model="form.invitorName" autocomplete="off"></el-input>
                </el-form-item>
                <el-form-item label="手机号">
                    <el-input v-model="form.mobile" autocomplete="off"></el-input>
                </el-form-item>
                <el-form-item label="角色">
                    <el-select v-model="form.role" placeholder="请选择角色">
                        <el-option label="一般用户" value="0"></el-option>
                        <el-option label="VIP" value="1"></el-option>
                        <el-option label="管理员" value="2"></el-option>
                    </el-select>
                </el-form-item>
                <el-form-item label="状态">
                    <el-select v-model="form.role" placeholder="请选择状态">
                        <el-option label="正常" value="0"></el-option>
                        <el-option label="禁用" value="1"></el-option>
                    </el-select>
                </el-form-item>
            </el-form>
            <div slot="footer" class="dialog-footer">
                <el-button @click="dialogFormVisible = false">取 消</el-button>
                <el-button type="primary" @click="handlesubmit">确 定</el-button>
            </div>
        </el-dialog>
    </div>
    <script src="./js/axios.min.js"></script>
    <script src="./js/vue.min.js"></script>
    <script src="./js/index.js"></script>
    <script>
        new Vue({
            el: '#app',
            data() {
                return {
                    formInline: {
                        userName: '',
                        invitorName: '',
                        mobile: '',
                        status: '',
                        role: '',
                        pageNo: 1,
                        pageSize: 10
                    },
                    tableData: [],
                    totalCount: 40,
                    dialogopt: {
                        title: '',
                        model: '',
                        dialogFormVisible: false
                    },
                    form: {
                        email: "",
                        id: null,
                        investAmount: 0,
                        invitorName: "",
                        mobile: "",
                        role: "0",
                        status: "0",
                        userName: ""
                    }
                }
            },
            methods: {
                /**
                 * @description 搜索
                */
                onSubmit() {

                },
                /**
                 * @descripiton 当前页数改变
                */
                handleCurrentChange(val) {
                    this.formInline.pageNo = val;
                },
                /**
                 * @descripiton 当前每页条数改变
                */
                handleSizeChange(val) {
                    this.formInline.pageSize = val;
                },
                hanle( item, index, type){
                    if(type == 'add'){
                        this.dialogopt.title = '新增用户';
                    }else{
                        this.dialogopt.title = '编辑用户'
                    }
                    this.dialogopt.model = type;
                    this.dialogopt.dialogFormVisible = true;
                },
                handlesubmit(){
                    if(this.dialogopt.model == 'add'){
                        axios.post('/member', this.form).then((res) => {
                            console.log(res);
                        }).catch((err) => {
                            console.log(err);
                        });
                    }
                }
            }
        });
    </script>
</body>

</html>